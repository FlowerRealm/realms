# Realms systemd EnvironmentFile: /etc/realms/realms.env
#
# 安装（Debian/Ubuntu）后默认会自动启动 realms.service，
# 修改本文件后执行：systemctl restart realms

# 基础
REALMS_ENV=prod
REALMS_ADDR=:8080
REALMS_PUBLIC_BASE_URL=
# HTTP Server（连接硬化：10k-100k 连接场景建议设置）
# - WriteTimeout 保持为 0（不设置），避免影响 SSE 等长连接响应
REALMS_SERVER_READ_HEADER_TIMEOUT_SECONDS=5
REALMS_SERVER_READ_TIMEOUT_SECONDS=30
REALMS_SERVER_IDLE_TIMEOUT_SECONDS=120
REALMS_SERVER_MAX_HEADER_BYTES=1048576
# Request body limits (for routes using BodyCache)
REALMS_PUBLIC_MAX_BODY_BYTES=1048576
REALMS_OPENAI_MAX_BODY_BYTES=8388608
# Upstream HTTP transport (pool & timeouts)
REALMS_UPSTREAM_HTTP_DIAL_TIMEOUT_SECONDS=30
REALMS_UPSTREAM_HTTP_TLS_HANDSHAKE_TIMEOUT_SECONDS=10
REALMS_UPSTREAM_HTTP_MAX_IDLE_CONNS=1024
REALMS_UPSTREAM_HTTP_MAX_IDLE_CONNS_PER_HOST=256
REALMS_UPSTREAM_HTTP_MAX_CONNS_PER_HOST=0
REALMS_UPSTREAM_HTTP_IDLE_CONN_TIMEOUT_SECONDS=90
 
# Scheduler upstream snapshot cache（减少每请求读取 channels/endpoints/credentials 的 DB QPS）
# REALMS_UPSTREAM_SNAPSHOT_TTL_MILLIS=2000

# usage_events retention（可选：启用后会定期补算 rollup 并清理历史明细）
# REALMS_USAGE_EVENTS_RETENTION_DAYS=30

# 初次部署建议临时允许注册：第一个注册用户会成为 root；完成初始化后建议改为 false
REALMS_ALLOW_OPEN_REGISTRATION=true

# 无 TLS/反向代理的纯 HTTP 场景：需要允许非 Secure Cookie，否则 Web 登录会不可用
REALMS_DISABLE_SECURE_COOKIES=true

# SQLite（默认，单机部署）
REALMS_DB_DSN=
REALMS_DB_DRIVER=sqlite
REALMS_SQLITE_PATH=/var/lib/realms/data/realms.db?_busy_timeout=30000

# 运行时数据目录
REALMS_TICKETS_ATTACHMENTS_DIR=/var/lib/realms/data/tickets
