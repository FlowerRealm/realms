# 变更提案: Codex OAuth 用量展示口径修复（5 小时 / 每周）

## 需求背景

当前管理后台 `/admin` 的 Codex OAuth 账号列表里，“用量/额度”显示为“主额度窗口 / 次额度窗口”，且主要只展示 used% 进度条。缺少窗口含义与“剩余可用额度（USD）”信息，导致管理员无法快速判断：
- 这个账号当前还能不能用
- 何时会恢复（重置时间）
- 剩余预算大概还有多少

本次修复目标是把两个窗口直接映射成团队账号的两个额度桶，并在 UI 上以业务语言展示：
- `primary_window` → **5 小时额度**（团队账号口径：$6 / 5h）
- `secondary_window` → **周限额与代码审查额度**（团队账号口径：$20 / week）

并且同时显示：
- 百分比（已用/剩余）
- 重置时间
- 剩余金额（USD，按额度上限与 `used_percent` 反算）

## 变更内容

1. `/admin` 页面改名：把“主额度/次额度”改成“5 小时额度 / 周限额与代码审查额度”
2. 额度展示补全：在进度条下展示“剩余 $X/$Cap · 重置 <time>”
3. 兼容与降级：当上游字段缺失或解析失败时，保持 `-` 或错误信息展示，不影响现有管理功能

## 影响范围

- **模块:** `internal/admin`
- **文件:**
  - `internal/admin/server.go`
  - `internal/admin/templates/endpoints.html`
- **API:** 无
- **数据:** 无（不改表）

## 核心场景

### 需求: 管理后台可读的额度窗口展示
**模块:** admin  
将 Codex OAuth 的两个 quota window 按业务口径展示为 5 小时与每周两个额度桶，并提供剩余金额。

#### 场景: 查看账号额度（正常）
管理员在 `/admin` 的 Codex OAuth 账号列表中查看某个账号：
- 5 小时额度与每周额度分别显示进度条（`used_percent`）
- 同时显示剩余金额（按 $6/5h 与 $20/week 计算）与重置时间
- 未获取到字段时显示 `-`，不展示误导性的数值

#### 场景: 上游拉取失败（错误）
当 quota 刷新失败：
- 页面显示 `QuotaError`
- 不显示误导性的剩余金额/重置时间/进度条明细

## 风险评估

- **风险:** 上游 `primary_window/secondary_window` 的语义可能变化，或 `used_percent` 并非严格对应 USD 成本。
- **缓解:** UI 文案明确“按 Team 口径（$6/5h、$20/week）计算”，并在 `PlanType` 非 Team 时可选择仅展示百分比+重置时间。

