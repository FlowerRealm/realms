{{define "page_tickets"}}
<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h3 class="mb-1 fw-bold">工单</h3>
    <div class="text-muted small">查看与管理您的所有工单记录。</div>
  </div>
  <a class="btn btn-primary " href="/tickets/new">
    <span class="me-1 material-symbols-rounded">add</span> 创建工单
  </a>
</div>

{{if .Error}}
<div class="alert alert-danger "><span class="me-2 material-symbols-rounded">warning</span>{{.Error}}</div>
{{end}}

<div class="card  border-0 overflow-hidden">
  <div class="card-body p-0">
    <div class="p-3 border-bottom d-flex gap-2 bg-light rounded-top">
      <a class="btn btn-sm btn-white border " href="/tickets">全部</a>
      <a class="btn btn-sm btn-white border " href="/tickets/open">进行中</a>
      <a class="btn btn-sm btn-white border " href="/tickets/closed">已关闭</a>
    </div>

    {{if not .Tickets}}
      <div class="text-center py-5 text-muted">
        <span class="fs-1 d-block mb-3 opacity-50 material-symbols-rounded">inbox</span>
        <p>暂无工单记录</p>
        <a href="/tickets/new" class="btn btn-sm btn-outline-primary">创建一个新工单</a>
      </div>
    {{else}}
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th class="ps-4" style="width: 80px;">ID</th>
              <th>标题</th>
              <th style="width: 120px;">状态</th>
              <th style="width: 180px;">最后更新</th>
              <th style="width: 180px;">创建时间</th>
              <th style="width: 100px;"></th>
            </tr>
          </thead>
          <tbody>
            {{range .Tickets}}
            <tr>
              <td class="ps-4 text-muted font-monospace">#{{.ID}}</td>
              <td class="fw-medium text-dark">{{.Subject}}</td>
              <td><span class="badge rounded-pill {{.StatusBadge}}">{{.StatusText}}</span></td>
              <td class="text-muted small">{{.LastMessageAt}}</td>
              <td class="text-muted small">{{.CreatedAt}}</td>
              <td class="text-end pe-4">
                <a class="btn btn-sm btn-light border" href="/tickets/{{.ID}}">查看</a>
              </td>
            </tr>
            {{end}}
          </tbody>
        </table>
      </div>
    {{end}}
  </div>
  <div class="card-footer bg-white small text-muted border-top-0 py-3">
    <span class="me-1 material-symbols-rounded">info</span>系统会自动清理超过 7 天的附件，请及时下载保存。
  </div>
</div>
{{end}}
