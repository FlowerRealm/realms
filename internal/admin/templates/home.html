{{define "admin_home"}}
<div class="d-flex align-items-center justify-content-between mb-4">
  <h2 class="h4 fw-bold mb-0 text-dark">仪表盘</h2>
  <span class="badge bg-white text-secondary border shadow-sm">{{.AdminTimeZoneEffective}} 时间</span>
</div>

<!-- 关键指标 -->
<div class="row g-4 mb-4">
  <!-- 用户 -->
  <div class="col-md-4">
    <div class="card h-100 border-0 shadow-sm metric-card" style="border-top: 3px solid var(--bs-primary) !important;">
      <div class="card-body d-flex align-items-center">
        <div class="bg-primary bg-opacity-10 p-3 rounded-circle me-3">
          <i class="ri-group-line fs-4 text-primary"></i>
        </div>
        <div>
          <h6 class="text-muted text-uppercase mb-1 small fw-semibold">总用户数</h6>
          <h3 class="mb-0 fw-bold text-dark">{{.Stats.UsersCount}}</h3>
        </div>
      </div>
    </div>
  </div>

  <!-- 渠道 -->
  <div class="col-md-4">
    <div class="card h-100 border-0 shadow-sm metric-card" style="border-top: 3px solid #10b981 !important;">
      <div class="card-body d-flex align-items-center">
        <div class="bg-success bg-opacity-10 p-3 rounded-circle me-3">
          <i class="ri-git-merge-line fs-4 text-success"></i>
        </div>
        <div>
          <h6 class="text-muted text-uppercase mb-1 small fw-semibold">上游渠道</h6>
          <h3 class="mb-0 fw-bold text-dark">{{.Stats.ChannelsCount}}</h3>
        </div>
      </div>
    </div>
  </div>

  <!-- 端点 -->
  <div class="col-md-4">
    <div class="card h-100 border-0 shadow-sm metric-card" style="border-top: 3px solid #0ea5e9 !important;">
      <div class="card-body d-flex align-items-center">
        <div class="bg-info bg-opacity-10 p-3 rounded-circle me-3">
          <i class="ri-server-line fs-4 text-info"></i>
        </div>
        <div>
          <h6 class="text-muted text-uppercase mb-1 small fw-semibold">上游节点</h6>
          <h3 class="mb-0 fw-bold text-dark">{{.Stats.EndpointsCount}}</h3>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 今日统计 -->
<div class="card border-0 shadow-sm mb-4 overflow-hidden">
  <div class="card-header bg-white border-bottom py-3 px-4 d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-center">
       <div class="rounded-circle bg-primary p-1 me-2"></div>
       <span class="fw-bold text-dark text-uppercase small">今日概览</span>
       <span class="text-muted smaller ms-2">{{$.AdminTimeZoneEffective}} 时间</span>
    </div>
    <div class="text-muted smaller">
       <i class="ri-pulse-line me-1 text-primary"></i> 实时监控
    </div>
  </div>
  <div class="card-body p-4">
    <div class="row text-center">
      <div class="col-md-4 border-end">
        <h6 class="text-muted mb-2 small fw-semibold text-uppercase">总请求数</h6>
        <h2 class="fw-bold text-dark">{{.Stats.RequestsToday}}</h2>
      </div>
      <div class="col-md-4 border-end">
        <h6 class="text-muted mb-2 small fw-semibold text-uppercase">Token 消耗</h6>
        <h2 class="fw-bold text-dark">{{.Stats.TokensToday}}</h2>
        <div class="small text-muted font-monospace mt-1">
          <span class="me-2"><i class="ri-arrow-up-line text-success"></i> {{.Stats.InputTokensToday}}</span>
          <span><i class="ri-arrow-down-line text-primary"></i> {{.Stats.OutputTokensToday}}</span>
        </div>
      </div>
      <div class="col-md-4">
        <h6 class="text-muted mb-2 small fw-semibold text-uppercase">预估消费</h6>
        <h2 class="fw-bold text-primary">{{.Stats.CostToday}}</h2>
      </div>
    </div>
  </div>
</div>

<!-- 快捷入口 -->
<div class="row g-4">
  <div class="col-md-6">
    <div class="card h-100 border-0 shadow-sm">
      <div class="card-body">
        <h5 class="card-title fw-bold mb-3 text-dark h6">快捷操作</h5>
        <div class="d-grid gap-2">
           <a href="/admin/channels" class="btn btn-outline-primary text-start border-light shadow-sm text-dark hover-white">
             <i class="ri-git-merge-line me-2 text-primary"></i> 管理上游渠道
           </a>
           <a href="/admin/users" class="btn btn-outline-primary text-start border-light shadow-sm text-dark hover-white">
             <i class="ri-user-settings-line me-2 text-primary"></i> 管理用户与权限
           </a>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-6">
    <div class="card h-100 border-0 shadow-sm">
      <div class="card-body">
        <h5 class="card-title fw-bold mb-3 text-dark h6">系统信息</h5>
        <ul class="list-unstyled mb-0">
          <li class="mb-3 d-flex align-items-center">
            <span class="text-muted small me-2">当前用户:</span> 
            <strong class="text-dark">{{.User.Email}}</strong>
          </li>
          <li class="mb-3 d-flex align-items-center">
            <span class="text-muted small me-2">角色权限:</span> 
            <span class="badge bg-primary bg-opacity-10 text-primary px-3 py-2 rounded-pill">{{.User.Role}}</span>
          </li>
          <li class="d-flex align-items-center">
            <span class="text-muted small me-2">服务状态:</span> 
            <span class="badge bg-success bg-opacity-10 text-success px-3 py-2 rounded-pill">
              <i class="ri-checkbox-circle-fill me-1"></i> 运行中
            </span>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
<style>
  .hover-white:hover { color: #fff !important; border-color: var(--bs-primary) !important; }
  .hover-white:hover i { color: #fff !important; }
</style>
{{end}}
